<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="471px" preserveAspectRatio="none" style="width:4439px;height:471px;background:#FFFFFF;" version="1.1" viewBox="0 0 4439 471" width="4439px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="500" x="1968.75" y="28.5352">sequence diagram - deploy an existing service to a new environment</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="66" x2="66" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="933" x2="933" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1016" x2="1016" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2608.5" x2="2608.5" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="3714.5" x2="3714.5" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="4229.5" x2="4229.5" y1="118.9766" y2="390.082"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="4354.5" x2="4354.5" y1="118.9766" y2="390.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="5" y="116.0234">ServiceDeveloper</text><ellipse cx="66.5" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,58.9883 L66.5,85.9883 M53.5,66.9883 L79.5,66.9883 M66.5,85.9883 L53.5,100.9883 M66.5,85.9883 L79.5,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="5" y="402.6172">ServiceDeveloper</text><ellipse cx="66.5" cy="414.0703" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,422.0703 L66.5,449.0703 M53.5,430.0703 L79.5,430.0703 M66.5,449.0703 L53.5,464.0703 M66.5,449.0703 L79.5,464.0703 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="904" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="911" y="108.0234">github</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="904" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="911" y="409.6172">github</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="973" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="980" y="108.0234">cenv_ci_cd</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="973" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="980" y="409.6172">cenv_ci_cd</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="2575.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="2582.5" y="108.0234">cenv_cli</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="2575.5" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="2582.5" y="409.6172">cenv_cli</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="3652.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="3659.5" y="108.0234">AWS_AppConfig</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="3652.5" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="3659.5" y="409.6172">AWS_AppConfig</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="4193.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="4200.5" y="108.0234">GH_repo</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="4193.5" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="4200.5" y="409.6172">GH_repo</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="4276.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="4283.5" y="108.0234">AWS_ParameterStore</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="4276.5" y="389.082"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="4283.5" y="409.6172">AWS_ParameterStore</text><polygon fill="#181818" points="921.5,146.2871,931.5,150.2871,921.5,154.2871,925.5,150.2871" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66.5" x2="927.5" y1="150.2871" y2="150.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="73.5" y="145.5449">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="830" x="86.5" y="145.5449">A developer creates a new branch for the environment using the environment branch naming convention env/newEnvironmentName</text><polygon fill="#181818" points="2597,175.5977,2607,179.5977,2597,183.5977,2601,179.5977" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1016" x2="2603" y1="179.5977" y2="179.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1023" y="174.8555">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1556" x="1036" y="174.8555">The cenv_ci_cd github action workflow invokes determines that a new environment branch has been created that has not been configured to host applications for the new environment so it runs "cenv init -e [newEnvironmentName] -aa --defaults"</text><polygon fill="#181818" points="3703,204.9082,3713,208.9082,3703,212.9082,3707,208.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2609" x2="3709" y1="208.9082" y2="208.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2616" y="204.166">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="669" x="2629" y="204.166">The cenv_cli creates the required backend infrastructure to manage each new app on the new environment</text><polygon fill="#181818" points="4218,234.2188,4228,238.2188,4218,242.2188,4222,238.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2609" x2="4224" y1="238.2188" y2="238.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2616" y="233.4766">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1584" x="2629" y="233.4766">The cenv_cli then generates local .cenv.newBranchName and .cenv.newBranchName.config files for each application environment that is in the mono repo. Package tags, namely package.nx.tags[ec:sls] || [ec:ecs] determine which services are configured</text><polygon fill="#181818" points="4343,278.8398,4353,282.8398,4343,286.8398,4347,282.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2609" x2="4349" y1="282.8398" y2="282.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2616" y="270.4424">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="2629" y="262.7871">Then the cli will create an environment specific copy of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="368" x="2633" y="278.0977">the services environment variables to AWS Parameter Store</text><polygon fill="#181818" points="4218,338.7715,4228,342.7715,4218,346.7715,4222,342.7715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2609" x2="4224" y1="342.7715" y2="342.7715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2616" y="322.7188">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442" x="2629" y="307.4082">Then the cli saves an environment config to the repo ".qa.cenv.config"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398" x="2629" y="322.7188">which the service will use as configuration when its running on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="2629" y="338.0293">that environment.</text><polygon fill="#181818" points="3703,368.082,3713,372.082,3703,376.082,3707,372.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="2609" x2="3709" y1="372.082" y2="372.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="2616" y="367.3398">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1069" x="2629" y="367.3398">the cli then creates an application configuration deployment so that the apps can actually retrieve a materialized environment specific configuration from AWS AppConfig</text><!--MD5=[271382526136a43c7ebaf41a30cf9120]
@startuml
'https://plantuml.com/sequence-diagram

autonumber

' need mechanism to figure out which services need to be updated if a given global parameter is updated
title sequence diagram - deploy an existing service to a new environment
actor ServiceDeveloper

ServiceDeveloper -> github: A developer creates a new branch for the environment using the environment branch naming convention env/newEnvironmentName
cenv_ci_cd -> cenv_cli: The cenv_ci_cd github action workflow invokes determines that a new environment branch has been created that has not been configured to host applications for the new environment so it runs "cenv init -e [newEnvironmentName] -aa - -defaults"
cenv_cli -> AWS_AppConfig: The cenv_cli creates the required backend infrastructure to manage each new app on the new environment
cenv_cli -> GH_repo: The cenv_cli then generates local .cenv.newBranchName and .cenv.newBranchName.config files for each application environment that is in the mono repo. Package tags, namely package.nx.tags[ec:sls] || [ec:ecs] determine which services are configured
cenv_cli -> AWS_ParameterStore: Then the cli will create an environment specific copy of\n the services environment variables to AWS Parameter Store
cenv_cli -> GH_repo: Then the cli saves an environment config to the repo ".qa.cenv.config" \nwhich the service will use as configuration when its running on \nthat environment.
cenv_cli -> AWS_AppConfig: the cli then creates an application configuration deployment so that the apps can actually retrieve a materialized environment specific configuration from AWS AppConfig

@enduml

@startuml

autonumber

title sequence diagram - deploy an existing service to a new environment
actor ServiceDeveloper

ServiceDeveloper -> github: A developer creates a new branch for the environment using the environment branch naming convention env/newEnvironmentName
cenv_ci_cd -> cenv_cli: The cenv_ci_cd github action workflow invokes determines that a new environment branch has been created that has not been configured to host applications for the new environment so it runs "cenv init -e [newEnvironmentName] -aa - -defaults"
cenv_cli -> AWS_AppConfig: The cenv_cli creates the required backend infrastructure to manage each new app on the new environment
cenv_cli -> GH_repo: The cenv_cli then generates local .cenv.newBranchName and .cenv.newBranchName.config files for each application environment that is in the mono repo. Package tags, namely package.nx.tags[ec:sls] || [ec:ecs] determine which services are configured
cenv_cli -> AWS_ParameterStore: Then the cli will create an environment specific copy of\n the services environment variables to AWS Parameter Store
cenv_cli -> GH_repo: Then the cli saves an environment config to the repo ".qa.cenv.config" \nwhich the service will use as configuration when its running on \nthat environment.
cenv_cli -> AWS_AppConfig: the cli then creates an application configuration deployment so that the apps can actually retrieve a materialized environment specific configuration from AWS AppConfig

@enduml

PlantUML version 1.2022.13(Sat Nov 19 07:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>