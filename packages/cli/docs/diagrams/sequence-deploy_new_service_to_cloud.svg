<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="548px" preserveAspectRatio="none" style="width:2667px;height:548px;background:#FFFFFF;" version="1.1" viewBox="0 0 2667 548" width="2667px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="696" x="984.5" y="28.5352">sequence diagram - deploy a new service to the cloud for the first time on the dev environment</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="66" x2="66" y1="118.9766" y2="467.9453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="562.5" x2="562.5" y1="118.9766" y2="467.9453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1008" x2="1008" y1="118.9766" y2="467.9453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1491" x2="1491" y1="118.9766" y2="467.9453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2431" x2="2431" y1="118.9766" y2="467.9453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2582" x2="2582" y1="118.9766" y2="467.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="5" y="116.0234">ServiceDeveloper</text><ellipse cx="66.5" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,58.9883 L66.5,85.9883 M53.5,66.9883 L79.5,66.9883 M66.5,85.9883 L53.5,100.9883 M66.5,85.9883 L79.5,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="5" y="480.4805">ServiceDeveloper</text><ellipse cx="66.5" cy="491.9336" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M66.5,499.9336 L66.5,526.9336 M53.5,507.9336 L79.5,507.9336 M66.5,526.9336 L53.5,541.9336 M66.5,526.9336 L79.5,541.9336 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="519.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="526.5" y="108.0234">cenv_ci_cd</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="519.5" y="466.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72" x="526.5" y="487.4805">cenv_ci_cd</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="975" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="982" y="108.0234">cenv_cli</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67" x="975" y="466.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="982" y="487.4805">cenv_cli</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="1455" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1462" y="108.0234">GH_repo</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73" x="1455" y="466.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1462" y="487.4805">GH_repo</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="2369" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="2376" y="108.0234">AWS_AppConfig</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="125" x="2369" y="466.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="2376" y="487.4805">AWS_AppConfig</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="2504" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="2511" y="108.0234">AWS_ParameterStore</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="157" x="2504" y="466.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="143" x="2511" y="487.4805">AWS_ParameterStore</text><polygon fill="#181818" points="550.5,146.2871,560.5,150.2871,550.5,154.2871,554.5,150.2871" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="66.5" x2="556.5" y1="150.2871" y2="150.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="73.5" y="145.5449">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="459" x="86.5" y="145.5449">A developer merges the service from a feature branch to the main branch</text><polygon fill="#181818" points="996.5,221.5293,1006.5,225.5293,996.5,229.5293,1000.5,225.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="562.5" x2="1002.5" y1="225.5293" y2="225.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="569.5" y="197.8213">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="405" x="582.5" y="174.8555">The cenv_ci_cd github action workflow invokes the cenv_cli and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396" x="582.5" y="190.166">passes along that it has a push on a service that matches a list</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403" x="582.5" y="205.4766">of predefined branch names and it also doesn't have a matching</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284" x="582.5" y="220.7871">environment variable file .[environment].cenv</text><polygon fill="#181818" points="1479.5,312.082,1489.5,316.082,1479.5,320.082,1483.5,316.082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1008.5" x2="1485.5" y1="316.082" y2="316.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1015.5" y="280.7188">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="1028.5" y="250.0977">The cenv_cli makes a copy of the .local.cenv in the root of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406" x="1028.5" y="265.4082">service and saves it to the repo as .qa.cenv. This file contains all</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="386" x="1028.5" y="280.7188">the environment specific variables for the service. The rest of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366" x="1028.5" y="296.0293">the variables are contained in the .cenv file and are shared</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="1028.5" y="311.3398">by all the other environments.</text><polygon fill="#181818" points="2419.5,341.3926,2429.5,345.3926,2419.5,349.3926,2423.5,345.3926" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1008.5" x2="2425.5" y1="345.3926" y2="345.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1015.5" y="340.6504">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1386" x="1028.5" y="340.6504">The cenv_cli then deploys a new QA AWS AppConfig application, configuration profile, environment, and adds an SNS Extension Association with the newly created AppConfig application and the invalidate lambdas topic.</text><polygon fill="#181818" points="2570.5,386.0137,2580.5,390.0137,2570.5,394.0137,2574.5,390.0137" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1008.5" x2="2576.5" y1="390.0137" y2="390.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1015.5" y="377.6162">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348" x="1028.5" y="369.9609">Then the cli will create an environment specific copy of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="700" x="1032.5" y="385.2715">the services environment variables to AWS Parameter Store from the local one the dev used to build the service.</text><polygon fill="#181818" points="1479.5,445.9453,1489.5,449.9453,1479.5,453.9453,1483.5,449.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1008.5" x2="1485.5" y1="449.9453" y2="449.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1015.5" y="429.8926">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442" x="1028.5" y="414.582">Then the cli saves an environment config to the repo ".qa.cenv.config"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="398" x="1028.5" y="429.8926">which the service will use as configuration when its running on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="1028.5" y="445.2031">that environment.</text><!--MD5=[1896f1949b950283e6077e1ef8f6797a]
@startuml
'https://plantuml.com/sequence-diagram

autonumber

' need mechanism to figure out which services need to be updated if a given global parameter is updated
title sequence diagram - deploy a new service to the cloud for the first time on the dev environment
actor ServiceDeveloper

ServiceDeveloper -> cenv_ci_cd: A developer merges the service from a feature branch to the main branch
cenv_ci_cd -> cenv_cli: The cenv_ci_cd github action workflow invokes the cenv_cli and \npasses along that it has a push on a service that matches a list \nof predefined branch names and it also doesn't have a matching \nenvironment variable file .[environment].cenv
cenv_cli -> GH_repo: The cenv_cli makes a copy of the .local.cenv in the root of the \nservice and saves it to the repo as .qa.cenv. This file contains all \nthe environment specific variables for the service. The rest of \nthe variables are contained in the .cenv file and are shared \nby all the other environments.
cenv_cli -> AWS_AppConfig: The cenv_cli then deploys a new QA AWS AppConfig application, configuration profile, environment, and adds an SNS Extension Association with the newly created AppConfig application and the invalidate lambdas topic.
cenv_cli -> AWS_ParameterStore: Then the cli will create an environment specific copy of\n the services environment variables to AWS Parameter Store from the local one the dev used to build the service.
cenv_cli -> GH_repo: Then the cli saves an environment config to the repo ".qa.cenv.config" \nwhich the service will use as configuration when its running on \nthat environment.

@enduml

@startuml

autonumber

title sequence diagram - deploy a new service to the cloud for the first time on the dev environment
actor ServiceDeveloper

ServiceDeveloper -> cenv_ci_cd: A developer merges the service from a feature branch to the main branch
cenv_ci_cd -> cenv_cli: The cenv_ci_cd github action workflow invokes the cenv_cli and \npasses along that it has a push on a service that matches a list \nof predefined branch names and it also doesn't have a matching \nenvironment variable file .[environment].cenv
cenv_cli -> GH_repo: The cenv_cli makes a copy of the .local.cenv in the root of the \nservice and saves it to the repo as .qa.cenv. This file contains all \nthe environment specific variables for the service. The rest of \nthe variables are contained in the .cenv file and are shared \nby all the other environments.
cenv_cli -> AWS_AppConfig: The cenv_cli then deploys a new QA AWS AppConfig application, configuration profile, environment, and adds an SNS Extension Association with the newly created AppConfig application and the invalidate lambdas topic.
cenv_cli -> AWS_ParameterStore: Then the cli will create an environment specific copy of\n the services environment variables to AWS Parameter Store from the local one the dev used to build the service.
cenv_cli -> GH_repo: Then the cli saves an environment config to the repo ".qa.cenv.config" \nwhich the service will use as configuration when its running on \nthat environment.

@enduml

PlantUML version 1.2022.13(Sat Nov 19 07:22:17 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>